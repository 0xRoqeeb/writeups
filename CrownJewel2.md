# HTB Sherlock Challenge: Crown Jewel 2

## Challenge Details

- **Name:** Crown Jewel 2
- **Category:** DFIR (Digital Forensics and Incident Response)
- **Difficulty:** [Very Easy]
- **Points:** [e.g., 50 points]
- **Description:** [how to detect NTDS.dit dumping which is one of the most critical Active directory attacks. You will get your hands on event logs to respond to an attack where the attacker utilized ntdsutil utility to dump the NTDS.dit database.

]

## Write-Up

### 1. Introduction

**Sherlock Scenario:** Forela's Domain environment is pure chaos. Just got another alert from the Domain Controller indicating that the NTDS.dit database is being exfiltrated. Just one day prior, you responded to an alert on the same Domain Controller where an attacker dumped NTDS.dit via the `vssadmin` utility. Although you managed to delete the dumped files, kick the attacker out of the DC, and restore a clean snapshot, the attackers have returned. This time, they have accessed the DC with a domain admin account using their persistent access in the environment and are abusing `ntdsutil` to dump the database again. Help Forela in these chaotic times!


we first downloaded the files related to the incident. it was an archive, after extracting it
We have three `.evtx` files, namely `Application`, `Security`, and `System`.




An EVTX file is a log file format used by the Windows Event Log service to store event logs. It is an acronym for "Event Log File"
Each log file type captures different events:
**Application.evtx:** Logs related to software applications running on the system (e.g., crashes, warnings).
**Security.evtx:** Logs related to security, such as logins, logouts, and other audit activities.
**System.evtx:** Logs generated by system components like drivers, services, and other core functions.

## First Question
When utilizing ntdsutil.exe to dump NTDS on disk, it simultaneously employs the Microsoft Shadow Copy Service. What is the most recent timestamp at which this service entered the running state, signifying the possible initiation of the NTDS dumping process?

since we're dealing with a service we should focus on the System.evtx log, where Windows services' status changes are recorded.




### 2. Enumeration

Detail the steps you took to gather information. Include any tools or techniques used.

### 3. Analysis

Explain how you analyzed the data or evidence. Include any relevant tools or techniques.

### 4. Findings

Discuss the key findings from your analysis and how they led to solving the challenge.

### 5. Solution

Summarize the final solution to the challenge. Include any relevant commands or scripts.

### 6. Flags

Provide the flags or proof of completion, if required.

### 7. Conclusion

Reflect on the challenge and any key takeaways.

## References

- [Link to the challenge page]
- [Link to any relevant tools or resources used]

